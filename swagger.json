{
  "openapi": "3.0.0",
  "info": {
    "title": "Novel-server",
    "version": "1.0.0",
    "description": "This is a server for Novel project.",
    "license": {
      "name": "Licensed Under MIT",
      "url": "https://spdx.org/licenses/MIT.html"
    },
    "contact": {
      "name": "JSONPlaceholder",
      "url": "https://jsonplaceholder.typicode.com"
    }
  },
  "servers": [
    {
      "url": "http://localhost:3000",
      "description": "Development server"
    }
  ],
  "paths": {
    "/register": {
      "post": {
        "summary": "Used to register new user",
        "tags": [
          "Auth regular user"
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "login",
                  "password",
                  "repeatedPassword"
                ],
                "properties": {
                  "login": {
                    "type": "string",
                    "description": "unique login that will be used to log in"
                  },
                  "password": {
                    "type": "string",
                    "description": "password"
                  },
                  "repeatedPassword": {
                    "type": "string",
                    "description": "the same password repated twice"
                  }
                },
                "example": {
                  "login": "myLogin",
                  "password": "Pa$sWorD",
                  "repeatedPassword": "Pa$sWorD"
                }
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "A successful resposne"
          },
          "422": {
            "description": "Missing required data or incorrect type"
          },
          "500": {
            "description": "An error occured while trying to register new user"
          }
        }
      }
    },
    "/login": {
      "post": {
        "summary": "Used to log in regular user",
        "tags": [
          "Auth regular user"
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "login",
                  "poassword"
                ],
                "properties": {
                  "login": {
                    "type": "string",
                    "description": "the same login that was used to register"
                  },
                  "password": {
                    "type": "string",
                    "description": "the smae password that was used to register"
                  }
                },
                "example": {
                  "login": "myLogin",
                  "password": "Pa$sWorD"
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "access token and refresh token",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Tokens"
                }
              }
            }
          },
          "401": {
            "description": "Account with that login and password does not exist"
          },
          "422": {
            "description": "Missing required data or incorrect type"
          }
        }
      }
    },
    "/protected": {
      "get": {
        "summary": "sample protected route",
        "tags": [
          "Auth regular user"
        ],
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "schema": {
              "type": "string"
            },
            "required": true,
            "description": "The book id"
          }
        ],
        "responses": {
          "200": {
            "description": "The book description by id"
          },
          "401": {
            "description": "you are not logged in or your tokens expired"
          },
          "403": {
            "description": "you are logged in but you don't have permission for the resource"
          }
        }
      }
    },
    "/refresh-token": {
      "post": {
        "summary": "regerenates accessToken based on refreshToken",
        "tags": [
          "Auth regular user"
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "refreshToken"
                ],
                "properties": {
                  "refreshToken": {
                    "type": "string",
                    "description": "refreshToken obtained when logging in"
                  }
                },
                "example": {
                  "refreshToken": "5bhk88956redhjjgfhI1NiIsInR5cCI6IkpXVCJ9.B6rfTYJr4GHhdbig56y7h7hg4g4ghy6Hh6MTYzNDM3MjQ3fggfghreeghute3NjM0T.KVLILQs_Brp_WRtOmPGi86l40hOnoxnd32XK5rI33EQ"
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "The book was successfully created",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AccessToken"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized because of expired refreshToken (you have to logout and login again)"
          },
          "403": {
            "description": "Forbidden - refreshToken does not exist in DB (if you first got 401 and tried to refresh again you will get this  403 because refreshTokens are removed from DB when trying to refresh accessToken with expried refreshToken to save DB space)"
          },
          "422": {
            "description": "Missing or incorect refreshToken"
          }
        }
      }
    },
    "/logout": {
      "post": {
        "summary": "logout logged in user",
        "tags": [
          "Auth regular user"
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/Tokens"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "logout successed"
          },
          "422": {
            "description": "incorrect or missing refreshToken and/or accessToken"
          },
          "500": {
            "description": "Some error happened"
          }
        }
      }
    },
    "/cms/register": {
      "post": {
        "summary": "Used to register new admin in CMS",
        "tags": [
          "Auth CMS admins"
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "login",
                  "password",
                  "repeatedPassword"
                ],
                "properties": {
                  "login": {
                    "type": "string",
                    "description": "unique login that will be used to log in"
                  },
                  "password": {
                    "type": "string",
                    "description": "password"
                  },
                  "repeatedPassword": {
                    "type": "string",
                    "description": "the same password repated twice"
                  }
                },
                "example": {
                  "login": "myLogin",
                  "password": "Pa$sWorD",
                  "repeatedPassword": "Pa$sWorD"
                }
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "A successful resposne"
          },
          "422": {
            "description": "Missing required data or incorrect type"
          },
          "500": {
            "description": "An error occured while trying to register new user"
          }
        }
      }
    },
    "/cms/login": {
      "post": {
        "summary": "Used to log in admin in CMS",
        "tags": [
          "Auth CMS admins"
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "login",
                  "poassword"
                ],
                "properties": {
                  "login": {
                    "type": "string",
                    "description": "the same login that was used to register"
                  },
                  "password": {
                    "type": "string",
                    "description": "the smae password that was used to register"
                  }
                },
                "example": {
                  "login": "testLogin",
                  "password": "qwerty123"
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "access token and refresh token",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Tokens"
                }
              }
            }
          },
          "401": {
            "description": "Account with that login and password does not exist"
          },
          "422": {
            "description": "Missing required data or incorrect type"
          }
        }
      }
    },
    "/cms/protected": {
      "get": {
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "summary": "sample protected route",
        "tags": [
          "Auth CMS admins"
        ],
        "responses": {
          "200": {
            "description": "The book description by id"
          },
          "401": {
            "description": "you are not logged in or your tokens expired"
          },
          "403": {
            "description": "you are logged in but you don't have permission for the resource"
          }
        }
      }
    },
    "/cms/refresh-token": {
      "post": {
        "summary": "regerenates accessToken based on refreshToken",
        "tags": [
          "Auth CMS admins"
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "refreshToken"
                ],
                "properties": {
                  "refreshToken": {
                    "type": "string",
                    "description": "refreshToken obtained when logging in"
                  }
                },
                "example": {
                  "refreshToken": "5bhk88956redhjjgfhI1NiIsInR5cCI6IkpXVCJ9.B6rfTYJr4GHhdbig56y7h7hg4g4ghy6Hh6MTYzNDM3MjQ3fggfghreeghute3NjM0T.KVLILQs_Brp_WRtOmPGi86l40hOnoxnd32XK5rI33EQ"
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "The book was successfully created",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AccessToken"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized because of expired refreshToken (you have to logout and login again)"
          },
          "403": {
            "description": "Forbidden - refreshToken does not exist in DB (if you first got 401 and tried to refresh again you will get this  403 because refreshTokens are removed from DB when trying to refresh accessToken with expried refreshToken to save DB space)"
          },
          "422": {
            "description": "Missing or incorect refreshToken"
          }
        }
      }
    },
    "/cms/logout": {
      "post": {
        "summary": "logout logged in user",
        "tags": [
          "Auth CMS admins"
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/Tokens"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "logout successed"
          },
          "422": {
            "description": "incorrect or missing refreshToken and/or accessToken"
          },
          "500": {
            "description": "Some error happened"
          }
        }
      }
    }
  },
  "components": {},
  "tags": []
}